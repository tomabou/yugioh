6/14
基本的なカードリストを実装した

アルゴリズムに対する考察
状態数が10^20~10^30くらいで、各状態で100〜1000くらいの遷移先があって(確率的に決まることもある)、だいたい100回くらい遷移した後に成功できるか判定できるみたいなタスク
環境のモデルが完全に既知なんだけど、状態数が多くて近似なしに動的計画法するのは無理みたいなシチュエーション

一番安直にやろうとすると成功した瞬間を報酬1、他は0で、減衰率γ=1にしてn-step DQNのようなものを回して勝率=Q(s,a)を求める
関数近似器はDNNじゃなくていい

報酬も完全に既知だから、状態とアクションに依存した関数Q(s,a)じゃなくて状態だけに依存したV(s)で諸々のアルゴリズムが書ける

    書ける気もするけど、結局行動選ぶときにQ(s,a)に類するものを計算することになる
    性能もあまり変わらないのではないか

Rainbowまで盛り盛りしたほうが強いっちゃ強い
Double DQNにnstep載せるまではmustな香りがする (報酬がかなりスパースなのでnstep分伝播しないと学習が遅いはず)

Prioritized Experience Replayはたぶん効く
Duelingは微妙かも、分布型(C51/QR-DQN)は載せられたら載せたい
この辺のパーツの自前実装は一部苦行なのでpfrlあたりのライブラリを適当に引っ張ってくると良さそう


モデルが完全に分かってることによるDQNの改善
    (s,a)の組が与えられたときの遷移・報酬がわかっているので、(s,a)の組に対する期待値計算が正確にできる
    ほかは不明

6/15
遊戯王のコードを実装する上で強化学習フレームワークの使い方を知っておきたい
とりあえずpfrlの環境構築をしてみる

6/18
state空間とactionの設計方法について
V(s)に基づいた計算をしたい

この場合問題になるのはモンスターゲート
かなり遷移先が多い
遷移先のstateのリストを"state"として環境が返してくれればそれに基づいてactionを設計すればいいので完璧

モンスターゲートに関しては
Q(s,モンスターゲート)を禁じさせるのとE[V(モンスターゲートによる遷移先)]をモンテカルロ計算するのでどちらの精度が高いのかよくわからない


デステニードローとトレードインを実装した
魔法カードから順番に実装していくことにする
死者蘇生とかの特殊召喚に時に効果が誘発するところが難しそう
    誘発の段数は最大でも1段階かな？

6/19
アームズホール
    一枚墓地に送る　->　サーチ対象を選ぶ
ドロー系　
    手札を適当に捨てる　-> ランダムにドローする
これらをどのように実装すればいいかということだが間に状態を一つ挟んで, 中間状態を挟めばいい気がする

アームズホールは、
    特殊召喚系（次元融合死者蘇生モンスターゲート名推理）で
    誘発系  エアーマンクライスディスクガイ
    が出てきたときと同じような処理にする

ドロー系
    クライス
    蘇生系でディスクガイを持って生きたとき
    サイバーヴァリーa

actionの設計
CardEffectの場合
    card cards(対象カード)
Drawの場合
    枚数
特殊召喚誘発の場合
    card effectと一緒


効果発動のカードの引数をどうするか
    対象カードが複数ある時（クライスとか）は中間stateを入れて、分割する
        3オペランド命令に分割する感じ
            死者転生とかは分割するのが少しめんどくさい
            中間状態が多くなりすぎるかもしれない
    actionに対象を複数入れる
        action数がめちゃくちゃ多くなるかもしれない
            特に魔法石の採掘
        無駄なactionがあるかもしれない
            例えば重要なカードを捨てる手は全部読まなくていいみたいな

対象カード枚数リスト

0
ディスクガイ
名推理
成金ゴブリン
マジエク
1
サイバーヴァリー1
エアーマン
こんくろ
アームズホール
デステニードロー
モンスターゲート
トレードイン
死者蘇生
早すぎた埋葬
増援
2
サイバーヴァリー2
クライス(0,1でもいい)
フェニブレ
DDR
手札断殺
死者転生
3
ドグマガイ
魔法石の採掘 こいつだけ中間状態を挟んでごまかす


未確定
手札抹殺
次元融合


ToDo
Card.effectの引数を一つにする
effectごとに別の実装にする
runActionを実装する
action runでアームズホールの実行ができるようにする

